rl -s learning on # Reinforcement Llearning

sp {propose*initialize-escape
    (state <s> ^superstate nil 
              -^name)
-->
    (<s> ^operator <o> +)
    (<o> ^name initialize-escape)
    (write |Proposed!|)
}

sp {apply*initialize-escape
    (state <s> ^operator <op>)
    (<op> ^name initialize-escape)
-->
    (<s> ^name escape
         ^height 1.5
         ^location start
         ^direction <d1> <d2> <d3> <d4> <d5> <d6>
         ^escaped no)
      
    (<d1> ^name window_loc ^item <wn> ^reward -0.5)
    (<d2> ^name elastic_loc ^item <el> ^reward -10)
    (<d3> ^name stone_loc ^item <st> ^reward -10)
    (<d4> ^name twig_loc ^item <tw> ^reward -10)
    (<d5> ^name trunk1_loc ^item <tr1> ^reward -10)
    (<d6> ^name trunk2_loc ^item <tr2> ^reward -10)

    (<el> ^name elastic) 
    (<tw> ^name twig) # rametto
    (<st> ^name stones) 
    (<tr1> ^name trunk_1 ^height 1.0)   
    (<tr2> ^name trunk_2 ^height 1.0)
    (<wn> ^name window ^height 3.5)
    
    (write |initialized!|)
}

### Propose & Apply ### 
sp {propose*move
   (state <s> ^name escape
              ^direction <d> 
              ^location start)
   (<d> ^name <dir>)
-->
   (<s> ^operator <op> +) 
   (<op> ^name move 
         ^dir <dir>) 
}

sp {apply*move
   (state <s> ^operator <op> 
              ^location start)
   (<op> ^name move 
         ^dir <dir>)
-->
   (<s> ^location start - <dir>) 
   (write (crlf) |Moved: | <dir>)
}

sp {propose*take
   (state <s> ^name escape
              ^location <loc>
              ^direction <dir>)
   (<dir> ^name <loc>
          ^item <item>)
   (<item> ^name <item_name>)
   -(<item> ^name window)
-->
   (<s> ^operator <op> +)
   (<op> ^name take
         ^item <item_name>)
}

sp {apply*take
   (state <s> ^name escape
              ^operator <op>)
   (<op> ^name take 
         ^item <item>)
-->
   (<s> ^bag <item>)
   (write (crlf) |Item:| <item>)
}



### RL Rules
sp {rl*window
   (state <s> ^name escape 
              ^operator <op> +) 
   (<op> ^name move 
         ^dir window_loc) 
-->
   (<s> ^operator <op> = 0) 
}

sp {rl*elastic
   (state <s> ^name escape 
              ^operator <op> +) 
   (<op> ^name move 
         ^dir elastic_loc) 
-->
   (<s> ^operator <op> = 0) 
}

sp {rl*stone
   (state <s> ^name escape 
              ^operator <op> +) 
   (<op> ^name move 
         ^dir stone_loc) 
-->
   (<s> ^operator <op> = 0) 
}
sp {rl*twig
   (state <s> ^name escape 
              ^operator <op> +) 
   (<op> ^name move 
         ^dir twig_loc) 
-->
   (<s> ^operator <op> = 0) 
}
sp {rl*trunk1
   (state <s> ^name escape 
              ^operator <op> +) 
   (<op> ^name move 
         ^dir trunk1_loc) 
-->
   (<s> ^operator <op> = 0) 
}
sp {rl*trunk2
   (state <s> ^name escape 
              ^operator <op> +) 
   (<op> ^name move 
         ^dir trunk2_loc) 
-->
   (<s> ^operator <op> = 0) 
}

sp {elaborate*reward 
   (state <s> ^name escape
              ^reward-link <r> #reward-link
              ^location <d-name> 
              ^direction <dir>) 
   (<dir> ^name <d-name> ^reward <d-reward>) 
-->
   (<r> ^reward <rr>) 
   (<rr> ^value <d-reward>)
}

sp {elaborate*done
   (state <s> ^name escape
              ^bag {<> nil}) 
-->
   (halt)
}